#include "aes.h"
#include "../utils/general.h"
#include "../utils/pkcs7.h"

int main() {
    uint8_t key[16] = {
        0x1f, 0x8e, 0x49, 0x73, 0x95, 0x3f, 0x3f, 0xb0, 0xbd, 0x6b, 0x16, 0x66, 0x2e, 0x9a, 0x3c, 0x17
    };
    uint8_t input[16] = {
        0x45, 0xcf, 0x12, 0x96, 0x4f, 0xc8, 0x24, 0xab, 0x76, 0x61, 0x6a, 0xe2, 0xf4, 0xbf, 0x08, 0x22
    };
    uint8_t iv[16] = {
        0x2f, 0xe2, 0xb3, 0x33, 0xce, 0xda, 0x8f, 0x98, 0xf4, 0xa9, 0x9b, 0x40, 0xd2, 0xcd, 0x34, 0xa8
    };

    // uint8_t* cipher = NULL;
    // uint8_t* plain = NULL;
    // size_t plain_len = 0;
    // size_t cipher_len = 0;
    // aes_cbc_encrypt(input, 16, iv, key, 16, &cipher, &cipher_len);
    // print_byte_array(cipher, 32);
    // aes_cbc_decrypt(cipher, 32, iv, key, 16, &plain, &plain_len);
    // print_byte_array(plain, plain_len);
    // free(plain);
    // free(cipher);

    aes_cbc_test("./test_vectors/AESCBC128LongMsg.rsp");

    return 0;
}